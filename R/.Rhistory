post_smp<-proc[smp_tmp]
wdobs
smp_tmp<-sample(length(proc), N, replace=T, prob = wdobs)
smp_tmp<-sample(length(proc), length(proc), replace=T, prob = wdobs)
post_smp<-proc[smp_tmp]
hist(post_smp)
post_smp
hist(proc)
pars$obs = c(log(0.1, 0.2))
so = pars$obs
if(length(so)==1) {
std_tmp<-minsd+exp(so[1])*xt
} else {
std_tmp<-exp(so[1])+exp(so[2])*xt
}
hist(std_tmp)
min(std_tmp)
length(so)
so
so = c(log(0.1), log(0.2))
if(length(so)==1) {
std_tmp<-minsd+exp(so[1])*xt
} else {
std_tmp<-exp(so[1])+exp(so[2])*xt
}
min(std_tmp)
hist(std_tmp)
#Tobit distribution (modified from script by J.Clark):
if(yt == 0) {
tiny <- 10e-6
lo = -Inf; hi = 0 # lower and upper limits of normal quantiles for censored region in Tobit (i.e. values <= 0)
q1 <- pnorm(lo,xt,std_tmp)
q2 <- pnorm(hi,xt,std_tmp)
z <- runif(n = length(xt), min = q1, max = q2)
z <- qnorm(z,xt,std_tmp)
z[z == Inf]  <- lo[z == Inf] + tiny
z[z == -Inf] <- hi[z == -Inf] - tiny
LL = dnorm(z, xt, std_tmp, log = TRUE)
} else {
LL = dnorm(yt, xt, std_tmp, log = TRUE)
}
LL
plot(z, LL)
plot(xt, LL)
obsfun0<-function(so, yt, xt=NULL, inverse=FALSE, N=NULL, minsd=0.01, time=NULL) {
if(inverse) {
if(length(so)==1) {
std_tmp<-exp(so[1])*yt
} else {
std_tmp<-minsd+exp(so[1])*yt
}
std_tmp[std_tmp<minsd]<-minsd
pmax(0, rnorm(n = N, mean = yt, sd = std_tmp))
} else {
if(length(so)==1) {
std_tmp<-minsd+exp(so[1])*xt
} else {
std_tmp<-exp(so[1])+exp(so[2])*xt
}
#Tobit distribution (modified from script by J.Clark):
if(yt == 0) {
tiny <- 10e-6
lo = -Inf; hi = 0 # lower and upper limits of normal quantiles for censored region in Tobit (i.e. values <= 0)
q1 <- pnorm(lo,xt,std_tmp)
q2 <- pnorm(hi,xt,std_tmp)
# simulate potential values of y along a normal distribution given modeled mean and sd
z <- runif(n = length(xt), min = q1, max = q2)
z <- qnorm(z,xt,std_tmp)
z[z == Inf]  <- lo[z == Inf] + tiny
z[z == -Inf] <- hi[z == -Inf] - tiny
LL = dnorm(z, xt, std_tmp, log = TRUE)
} else {
LL = dnorm(yt, xt, std_tmp, log = TRUE)
}
return(LL)
}
}
pars$obs
pars$obs = c(log(0.1), log(0.2))
#get likelihood of proc given y[i]
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
i
y
yt
#get likelihood of proc given y[i]
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
#tmpobsout<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
#dobs<-tmpobsout$LL
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
plot(proc, wdobs)
plot(proc[proc>0], wdobs[proc>0])
yt
hist(xt)
min(xt[>0])
min(xt[xt>0])
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
wdobs
post_smp<-sample(proc, N, replace=T, prob = wdobs)
proc
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
post_smp
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 1, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
pars$obs
pars$obs = log(c(0.5, 0.2))
so = pars$obs
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
sort(unique(post_smp))
post_smp
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
proc = pmax(0, rnorm(1e3, 0, 1))
dobs<-obsfun(so = pars$obs, yt = y[i], xt = proc, time = i)
mxd<-max(dobs, na.rm=T)
wdobs<-exp(dobs-mxd)/sum(exp(dobs-mxd))
post_smp<-sample(proc, length(proc), replace=T, prob = wdobs)
hist(post_smp)
